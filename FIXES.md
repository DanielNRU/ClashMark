# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ ClashMark

## –û–±–∑–æ—Ä –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

–í –¥–∞–Ω–Ω–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ –æ–ø–∏—Å–∞–Ω—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –≤–Ω–µ—Å–µ–Ω–Ω—ã–µ –≤ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ClashMark –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏ —É–ª—É—á—à–µ–Ω–∏—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.

## 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫

### –ü—Ä–æ–±–ª–µ–º–∞
–ù–∞—Å—Ç—Ä–æ–π–∫–∏ "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏" –∏ "–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞" –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ.

### –ü—Ä–∏—á–∏–Ω–∞
–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É —Ç–∏–ø–æ–º —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Ñ–æ—Ä–º—ã –≤ HTML –∏ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –≤ Python:
- –í HTML –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è `<select>` –¥–ª—è `use_optimization`
- –í Python –æ–∂–∏–¥–∞–ª—Å—è checkbox (`'use_optimization' in request.form`)

### –†–µ—à–µ–Ω–∏–µ

#### 1.1 –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ HTML —Ñ–æ—Ä–º—ã
–í `templates/settings.html` –∑–∞–º–µ–Ω–µ–Ω select –Ω–∞ checkbox:

**–ë—ã–ª–æ:**
```html
<div class="form-group">
    <label>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞:</label>
    <select name="use_optimization" class="settings-input">
        <option value="true" {% if settings.use_optimization %}selected{% endif %}>–í–∫–ª—é—á–µ–Ω–∞</option>
        <option value="false" {% if not settings.use_optimization %}selected{% endif %}>–û—Ç–∫–ª—é—á–µ–Ω–∞</option>
    </select>
</div>
```

**–°—Ç–∞–ª–æ:**
```html
<div class="form-group">
    <label style="display: flex; align-items: center; cursor: pointer;">
        <input type="checkbox" name="use_optimization" {% if settings.use_optimization %}checked{% endif %}>
        –í–∫–ª—é—á–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
    </label>
</div>
```

#### 1.2 –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤ Python
–í `web/settings.py` –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ checkbox:

**–ë—ã–ª–æ:**
```python
'use_optimization': request.form.get('use_optimization') == 'true'
```

**–°—Ç–∞–ª–æ:**
```python
'use_optimization': 'use_optimization' in request.form
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏" —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ "–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞" —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã

## 2. –£–ª—É—á—à–µ–Ω–∏–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ "–ü—Ä–æ–≥—Ä–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è"

### –ü—Ä–æ–±–ª–µ–º–∞
–¢–∞–±–ª–∏—Ü—ã "–ú–µ—Ç—Ä–∏–∫–∏" –∏ "–ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫" –Ω–∞ –≤–∫–ª–∞–¥–∫–µ "–ü—Ä–æ–≥—Ä–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è" –Ω–µ –∏–º–µ–ª–∏ –µ–¥–∏–Ω–æ–≥–æ —Å—Ç–∏–ª—è —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫–µ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏".

### –†–µ—à–µ–Ω–∏–µ

#### 2.1 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ CSS —Å—Ç–∏–ª–µ–π
–í `templates/train_progress.html` –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã –º–µ—Ç—Ä–∏–∫:

```css
/* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü */
.metrics-table, .confusion-matrix {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    background: #fff;
    border-radius: 16px;
    box-shadow: 0 2px 16px #0001;
    overflow: hidden;
    margin-bottom: 24px;
    font-size: 16px;
    font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
}

.metrics-table th, .metrics-table td,
.confusion-matrix th, .confusion-matrix td {
    padding: 16px 20px;
    text-align: center;
    border: none;
    font-weight: 600;
    transition: background 0.2s;
}

.metrics-table th, .confusion-matrix th {
    background: #23408e;
    color: #fff;
    font-weight: 600;
    cursor: pointer;
    user-select: none;
}

.metrics-table th:hover, .confusion-matrix th:hover {
    background: #1a2a4f;
}

.metrics-table tr, .confusion-matrix tr {
    transition: background 0.2s;
}

.metrics-table tr:hover, .confusion-matrix tr:hover {
    background: #f0f4fa;
}

.metrics-table td, .confusion-matrix td {
    border-bottom: 1px solid #e9ecef;
    background: #fff;
    color: #23408e;
    font-weight: 600;
    font-size: 18px;
}

.metrics-table tr:last-child td, .confusion-matrix tr:last-child td {
    border-bottom: none;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –±–ª–æ–∫–æ–≤ */
.progress-block h3 {
    font-size: 1.4em;
    font-weight: 600;
    margin-bottom: 20px;
    color: #333;
    display: flex;
    align-items: center;
    gap: 8px;
    border-bottom: 2px solid #e9ecef;
    padding-bottom: 12px;
}
```

#### 2.2 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ HTML —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
–ò–∑–º–µ–Ω–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã –º–µ—Ç—Ä–∏–∫:

**–ë—ã–ª–æ:**
```html
<div id="train-metrics" class="progress-block">
    <h3>–ú–µ—Ç—Ä–∏–∫–∏</h3>
    <table id="metrics-table"></table>
</div>
```

**–°—Ç–∞–ª–æ:**
```html
<div id="train-metrics" class="progress-block">
    <h3>üìä –ú–µ—Ç—Ä–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è</h3>
    <div id="metrics-table"></div>
</div>
```

#### 2.3 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ JavaScript
–í —Ñ—É–Ω–∫—Ü–∏–∏ `updateMetricsTable()` –¥–æ–±–∞–≤–ª–µ–Ω CSS –∫–ª–∞—Å—Å:

**–ë—ã–ª–æ:**
```javascript
let html = '<thead><tr>' +
    '<th>–≠–ø–æ—Ö–∞</th>' +
    // ...
    '</tr></thead><tbody>';
```

**–°—Ç–∞–ª–æ:**
```javascript
let html = '<table class="metrics-table"><thead><tr>' +
    '<th>–≠–ø–æ—Ö–∞</th>' +
    // ...
    '</tr></thead><tbody></table>';
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ "–ú–µ—Ç—Ä–∏–∫–∏" –∏–º–µ–µ—Ç –µ–¥–∏–Ω—ã–π —Å—Ç–∏–ª—å —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ "–ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫" —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–≤–æ–π —Å—Ç–∏–ª—å
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–∫–æ–Ω–∫–∏ –∫ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º –¥–ª—è –ª—É—á—à–µ–≥–æ UX
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∏ –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

## 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
–°–æ–∑–¥–∞–Ω –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω —Ç–µ—Å—Ç `test_settings.py`:
```
‚úÖ –¢–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω —É—Å–ø–µ—à–Ω–æ!
‚úÖ model_file: test_model.pt
‚úÖ low_confidence: 0.25
‚úÖ high_confidence: 0.75
‚úÖ inference_mode: model
‚úÖ manual_review_enabled: True
‚úÖ export_format: bimstep
‚úÖ model_type: efficientnet_b0
‚úÖ use_optimization: False
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –í—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

## 4. –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º:
- –°—Ç–∞—Ä—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ—Å—Ç–∞–µ—Ç—Å—è –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–º
- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –Ω–µ –Ω–∞—Ä—É—à–µ–Ω–∞

## 5. –§–∞–π–ª—ã, –ø–æ–¥–≤–µ—Ä–≥—à–∏–µ—Å—è –∏–∑–º–µ–Ω–µ–Ω–∏—è–º

1. **`templates/settings.html`**
   - –ó–∞–º–µ–Ω–∞ select –Ω–∞ checkbox –¥–ª—è use_optimization
   - –£–ª—É—á—à–µ–Ω–∏–µ UX

2. **`web/settings.py`**
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ checkbox
   - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

3. **`templates/train_progress.html`**
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ CSS —Å—Ç–∏–ª–µ–π –¥–ª—è —Ç–∞–±–ª–∏—Ü
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ HTML —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
   - –£–ª—É—á—à–µ–Ω–∏–µ JavaScript —Ñ—É–Ω–∫—Ü–∏–π
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–∫–æ–Ω–æ–∫ –∫ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º

## 6. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
   - –¢–µ–ø–µ—Ä—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
   - –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å—Ç–∞–ª –±–æ–ª–µ–µ –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–º –∏ –∫—Ä–∞—Å–∏–≤—ã–º

2. **–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:**
   - –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å checkbox –¥–ª—è –±—É–ª–µ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
   - –°–ª–µ–¥–æ–≤–∞—Ç—å –µ–¥–∏–Ω–æ–º—É —Å—Ç–∏–ª—é –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

## 7. –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

–í–æ–∑–º–æ–∂–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è:
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
- –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ 